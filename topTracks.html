<html>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/@observablehq/plot@0.4"></script>
    <style>
      .graph {
          padding-top: 80px;
          padding-bottom: 80px;
      }
      .head-section {
          font:  bold italic 18px Georgia,'Times New Roman',serif;
      }
      .contents {
          font-style: italic;
      }
    </style>
    <div id="graphone" class="graph"></div>
    <script>
      const dataDownloaded = new Event('dataDownloaded', {bubbles: true});

      async function g() {
          const res = await fetch(`https://raw.githubusercontent.com/llimllib/nbastats/cb9551776bcfdce57177d2e569da0e1d70f58890/playoff/data.json`);
          const song1 = [
              {
                  "from": 1679832000,
                  "to": 1680436800,
                  "rank": 1
              },
              {
                  "from": 1679227200,
                  "to": 1679832000,
                  "rank": 3
              },
          ]

          const stats = await res.json();
          window.stats = stats; // let's not re-download it. Save it as a global
          window.data = data;
          window.song1 = song1;
          document.dispatchEvent(dataDownloaded);
          const dotplot = Plot.dot(stats, {
              x: "usg_pct",
              y: "ts_pct",
              stroke: "team",
              title: "name",
          }).plot();
          const linemark = Plot.plot({
              grid: true,
              x: {
                  domain: [new Date("2010-10-01"), new Date("2010-10-31")],
                  type: "time",
                  label: "Months",
                  grid: true
              },
              y: {
                  grid: true,
                  label: "↑ Temperature (°F)"
                  //range: [50,90]
              },
              marks: [
                  //Plot.axisX({anchor: "bottom", ticks: 30, tickSize: 1}),
                  //no idea why this doesn't work?
                  Plot.line(data, {sort: "date", x: "date", y: "low", stroke: "#4e79a7"}),
                  Plot.line(data, {sort: "date", x: "date", y: "high", stroke: "#e15759"}),
                  Plot.ruleY([32]) // freezing
              ]
          })
                          const songPlot = Plot.plot({
                              grid: true,
                              x: {
                                  type: "utc",
                                  label: "time",
                                  grid: true
                              },
                              y: {
                                  grid: true,
                                  label: "rank"
                              },
                              marks: [
                                  Plot.line(song1, {sort: "date", x: "to", y: "rank"})
                              ]
                          })
          document.body.append(dotplot);
          document.body.append(linemark);
          document.body.append(songPlot);
      }
      window.addEventListener("DOMContentLoaded", async (_evt) => {
          await g();
      });
    </script>
  </body>
</html>
